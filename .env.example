# =============================================================================
# AstraDesk Environment Example
# Copy this file to `.env` and fill in the values that apply to your setup.
#
# Each section groups variables by the service/module that consumes them so you
# can tell at a glance which component needs the value.
# =============================================================================


# -----------------------------------------------------------------------------
# Global / Shared Settings
# -----------------------------------------------------------------------------
# Generic log level used by multiple services (Python API, auditor, etc.).
LOG_LEVEL=INFO

# Event bus address shared by the API gateway and the auditor stream processor.
NATS_URL=nats://localhost:4222

# Open Policy Agent URL used by the API gateway for authorization decisions.
OPA_URL=http://localhost:8181

# LLM provider selector for services/api-gateway (openai | bedrock | vllm).
MODEL_PROVIDER=openai

# Runtime policy loading for services/api-gateway/src/runtime/policy.py.
POLICY_JSON=
POLICY_FILE=
POLICY_TTL_SECONDS=300

# Kubernetes namespace used by packages/domain-ops/tools/actions.py.
KUBERNETES_NAMESPACE=default


# -----------------------------------------------------------------------------
# API Gateway (services/api-gateway — FastAPI)
# -----------------------------------------------------------------------------
# Primary data stores.
DATABASE_URL=postgresql://astradesk:astrapass@localhost:5432/astradesk
REDIS_URL=redis://localhost:6379/0

# Admin API proxy configuration.
ADMIN_API_URL=http://localhost:8080/api/admin/v1

# JWT configuration for authenticating inbound requests.
JWT_SECRET_KEY=change-me
JWT_ALGORITHM=HS256

# Metrics endpoint consumed by tools/metrics.py.
MONITORING_API_URL=http://localhost:9090

# Ticket adapter proxy configuration consumed by tools/tickets_proxy.py.
TICKETS_BASE_URL=http://localhost:8082
TICKETS_API_TOKEN=
TICKETS_DISABLE_STUB=false
SERVICE_CERT=/etc/istio/certs/cert-chain.pem
SERVICE_KEY=/etc/istio/certs/key.pem
ROOT_CA=/etc/istio/certs/ca-cert.pem

# Optional integrations exposed through API tools.
WEATHER_API_KEY=

# --- LLM Provider Configuration (services/api-gateway/model_gateway) ---
OPENAI_API_KEY=
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-4o-mini
OPENAI_TIMEOUT_SEC=30

BEDROCK_MODEL_ID=anthropic.claude-3-sonnet-v1
AWS_REGION=us-east-1

VLLM_BASE_URL=http://localhost:8000/v1
VLLM_MODEL=meta-llama/Llama-3-8B-Instruct
VLLM_API_KEY=
VLLM_TIMEOUT_SEC=60


# -----------------------------------------------------------------------------
# Core Authentication Library (core/src/astradesk_core/utils/auth.py)
# -----------------------------------------------------------------------------
OIDC_ISSUER=https://your-issuer.example.com/
OIDC_AUDIENCE=astradesk-api
OIDC_JWKS_URL=https://your-issuer.example.com/.well-known/jwks.json
OIDC_JWKS_TTL=3600
OIDC_TIME_SKEW_LEEWAY=60


# -----------------------------------------------------------------------------
# Admin Portal (services/admin-portal — Next.js)
# -----------------------------------------------------------------------------
NEXT_PUBLIC_API_BASE_URL=http://localhost:8080/api/admin/v1
NEXT_PUBLIC_SIMULATION_MODE=true

# Optional server-side token used for authenticated API calls.
ASTRADESK_API_TOKEN=
ADMIN_API_TOKEN=

# Optional override for the OpenAPI spec used by tooling scripts.
ASTRA_OPENAPI_SPEC=


# -----------------------------------------------------------------------------
# Auditor Service (services/auditor — async worker)
# -----------------------------------------------------------------------------
# Streams audit events from NATS and persists to S3/Elasticsearch.
S3_BUCKET=astradesk-audit
ES_URL=http://localhost:9200
ES_INDEX=astradesk-audit
FLUSH_SIZE=100
FLUSH_INTERVAL_SEC=10


# -----------------------------------------------------------------------------
# Ticket Adapter (services/ticket-adapter-java — Spring WebFlux)
# -----------------------------------------------------------------------------
# Database connectivity (R2DBC + legacy JDBC fallbacks used by gradle bootRun).
MYSQL_URL=jdbc:mysql://localhost:3306/tickets?useSSL=false
MYSQL_URL_R2DBC=r2dbc:mysql://localhost:3306/tickets
MYSQL_USER=tickets
MYSQL_PASSWORD=tickets
MYSQL_DATABASE=tickets

# Spring configuration properties (application.yml) for ticket storage.
TICKET_DB_R2DBC_URL=r2dbc:mysql://localhost:3306/tickets
TICKET_DB_USER=tickets
TICKET_DB_PASSWORD=tickets

# External integrations configured via integration.* properties.
FRONTEND_BASE_URL=http://localhost:5173
JIRA_ENABLED=false
JIRA_BASE_URL=https://example.atlassian.net
JIRA_USERNAME=jira-bot@example.com
JIRA_API_TOKEN=
JIRA_PROJECT_KEY=ASTRA
JIRA_ISSUE_TYPE=Task
JIRA_DEFAULT_PRIORITY=Medium
SLACK_ENABLED=false
SLACK_WEBHOOK_URL=
SLACK_DEFAULT_CHANNEL=


# -----------------------------------------------------------------------------
# Domain Packs & External Tools (packages/domain-*) 
# -----------------------------------------------------------------------------
# Generic Admin API credentials used by sample domain pack adapters and gRPC tools.
API_URL=http://localhost:8080/api/admin/v1
API_TOKEN=

